---
import "@repo/ui/sakupi01.com.css";
import Head from "../components/common/Head.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";

interface Props {
  pageTitle?: string;
  description?: string;
  url: string;
}

const {
  pageTitle = "Home",
  description = "The personal website of saku. A Front-end developer, Design Technologist, and an enthusiast of all things about Web & UI",
  url,
} = Astro.props;
---

<!doctype html>
<html lang="ja">
  <head>
    <Head title={pageTitle} description={description} />

    <script>
      import { setupThemeToggle } from "../functions/setUpThemeToggle";
      setupThemeToggle();
    </script>

    <script>
      (async function () {
        // Anchor positioning Polyfill
        if (!("anchorName" in document.documentElement.style)) {
          // @ts-expect-error wip wip
          await import("https://unpkg.com/@oddbird/css-anchor-positioning");
        }
      })();
    </script>

    <script>
      // @ts-expect-error wip
      if (window.CSS && CSS.registerProperty) {
        window.CSS.registerProperty({
          name: "--gradPoint",
          syntax: "<percentage>",
          inherits: false,
          initialValue: "40%",
        });
      }

      (function () {
        // Original color palette
        const colorPalette = [
          "#fa744f",
          "#ffbcbc",
          "#4cd3c2",
          "#b7efcd",
          "#edffea",
          "#ffe75e",
          "#feb72b",
          "#e85f99",
          "#9399ff",
          "#dab8f3",
          "#ea7ad7",
          "#ce0f3d",
          "#fd2eb3",
          "#ffc6c7",
        ];
        // Function to add opacity to a color
        // @ts-expect-error wip
        function addOpacity(color, opacity = 0.4) {
          // Convert hex to rgba
          const r = parseInt(color.slice(1, 3), 16);
          const g = parseInt(color.slice(3, 5), 16);
          const b = parseInt(color.slice(5, 7), 16);
          return `rgba(${r}, ${g}, ${b}, ${opacity})`;
        }

        // Create a copy of the color palette to work with
        const availableColors = [...colorPalette];

        // Function to select and remove a random color from availableColors
        function selectRandomColor() {
          if (availableColors.length === 0) return "rgba(0, 0, 0, 0.4)";
          const randomIndex = Math.floor(
            Math.random() * availableColors.length
          );
          const selectedColor = availableColors[randomIndex];
          // Remove the selected color from availableColors
          availableColors.splice(randomIndex, 1);
          return addOpacity(selectedColor);
        }

        // Select 6 unique colors
        const color1 = selectRandomColor();
        const color2 = selectRandomColor();
        const color3 = selectRandomColor();
        const color4 = selectRandomColor();
        const color5 = selectRandomColor();
        const color6 = selectRandomColor();

        // Set color values on the element
        const slidesContainer = document.querySelector(".carousel-container");
        if (slidesContainer) {
          // @ts-expect-error wip
          slidesContainer.style.setProperty("--color1", color1);
          // @ts-expect-error wip
          slidesContainer.style.setProperty("--color2", color2);
          // @ts-expect-error wip
          slidesContainer.style.setProperty("--color3", color3);
          // @ts-expect-error wip
          slidesContainer.style.setProperty("--color4", color4);
          // @ts-expect-error wip
          slidesContainer.style.setProperty("--color5", color5);
          // @ts-expect-error wip
          slidesContainer.style.setProperty("--color6", color6);
        }
      })();
    </script>

    <meta name="generator" content={Astro.generator} />
  </head>
  <body class="page">
    <Header />
    <main>
      <slot />
    </main>
    <Footer />
  </body>
</html>
